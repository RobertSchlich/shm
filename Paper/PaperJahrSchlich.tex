\documentclass[12pt,a4paper]{scrartcl}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[color=yellow!15]{todonotes}
\usepackage{graphicx}
\usepackage[numbers, sort&compress, square]{natbib}

\usepackage{titlesec}
\usepackage{color}
\usepackage{booktabs}

% used for line numbering
\usepackage{lineno}

\usepackage[colorlinks, linkcolor=black, citecolor=blue, urlcolor=blue]{hyperref}

%\makeatletter
%\renewcommand\section{\@startsection{section}{1}{\z@}%
%                     {-7.5ex \@plus -1ex \@minus -10.2ex}%
%                     {2.3ex \@plus.2ex}%
%                     {\sffamily\large\bfseries}}
%\makeatother


\usepackage{geometry}
\geometry{a4paper, top=35mm, left=30mm, right=30mm, bottom=35mm,
headsep=10mm, footskip=12mm}

\title{\textbf{ \Large {Decentralized autonomous sensor fault detection using neural networks}}}
\author
{\large Katrin Jahr, Robert Schlich\\
\\
\normalsize{Degree program “Civil Engineering” (M.Sc.)}\\
\normalsize{Bauhaus-Universität Weimar, Germany}\\
\\
\normalsize{katrin.jahr@uni-weimar.de \qquad}
\normalsize{robert.schlich@uni-weimar.de}
}
\date{}

\clubpenalty = 10000 % schliesst Schusterjungen aus
\widowpenalty = 10000 \displaywidowpenalty = 10000% schliesst Hurenkinder aus 

\newenvironment{sciabstract}{%
\begin{quote} \itshape}
{\end{quote}}

\begin{document} 

% Double-space the manuscript.

\baselineskip20pt

% Make the title.

\maketitle 
\vspace{-2em}

% 
\sloppy
\setlength{\emergencystretch}{3pt}
\hyphenation{sample-rate auto-nomous moni-toring methods}

\begin{sciabstract}

The dependability and the accuracy of structural health moni\-toring systems can be affected by sensor faults. 
In this paper, the design and implementation of a wireless structural health monitoring system, capable of decentralized autonomous fault detection, are presented. 
For self-detecting sensor faults, each sensor node predicts expected sensor data and compares it to the measured sensor data. 
The predictions are computed using neural networks based on measured sensor data of adjacent sensor nodes.
In laboratory experiments, devised to validate the proposed approach, several simulated sensor faults are detected.
These results indicate that the use of neural networks for fault detection increases the dependability and the accuracy of structural health monitoring systems.

\end{sciabstract}

%----------------------------------------------------------------------------------------
%
%\linenumbers % Schaltet Zeilennummerierung ein
%\modulolinenumbers[5] % nur jede 5. Zeile
%\section*{Dictionary}
%
%\begin{tabular}{|l|l|}
%\hline 
%Sensorknoten (SunSPOT) & sensor node \\ 
%\hline 
%einzelner Messsensor (Thermometer) & sensor \\ 
%\hline 
%Knoten im neuronalen Netz & neuron \\ 
%\hline 
%eine abgeschlossene Messungreihe & test run \\ 
%\hline 
%gemessene Werte & sensor data \\ 
%\hline 
%vorhergesagte Werte & predicted data \\ 
%\hline 
%durch Vorhersage erwartete Werte & expected data \\ 
%\hline 
%einzelner Messwert & measurement \\ 
%\hline 
%Test & laboratory experiments\\ 
%\hline
%tatsächliche, nicht virtuelle Messung & actual measurement \\
%\hline
%Messaufbau & test setup \\
%\hline
%
%\end{tabular} 

%----------------------------------------------------------------------------------------

\section*{Introduction}

Civil engineering structures are exposed to various external impacts during their lifetime. 
Structural health monitoring (SHM) systems can be deployed to evaluate the conditions and to ensure the structural stability of civil engineering structures.
\citet{BisbySHM} defines SHM as "a non-destructive \textit{in-situ} structural evaluation method that uses any of several sensors which are attached to, or embedded in, a structure".
The obtained sensor data is collected by sensor nodes, and then analyzed and stored on a computer system over long periods of time. 
The analysis of the sensor data can reveal abnormal changes in material and geometric behaviour at an early stage.

Traditionally, the sensor nodes are connected to computer systems with cables.
Using wired SHM systems has several disadvantages, including expensive wiring, high installation and labor costs as well as inaccessibility of optimal sensor location with wires.
In wireless SHM systems, the sensor nodes communicate---through a basestation with each other and with computer systems--- via wireless transceivers, eradicating wiring-specific problems. However, when using wireless SHM systems, special attention has to be paid to data transfer. 
To reduce transmission time, storage space and power consumption, and to decrease the probability of data loss, the transmitted data can be reduced using embedded computing.

As data reduction strategy, the natural frequency of a structure can be calculated on the sensor nodes instead of transmitting the raw measurements.
Changes in the natural frequency result from changes in the vibration behavior, which indicate structural damage \citep{salawu1997detection}.
The natural frequency can be determined by analysing the frequency spectrum of a vibration of a structure.
The frequency spectrum shows the relationship between the frequencies and magnitudes---magnitudes represent the influence a certain frequency has in a vibration.
The natural frequency is defined as the frequency with the highest magnitude.
While the frequencies are specific for a structure, the scale of the magnitudes are dependent on the structure, the degree of the vibration and the observed location on the structure.
During a vibration, the magnitudes on different locations are correlated with each other.
\citep{rao2011fast}.

Over their lifetime, the wireless sensor nodes can become inaccurate, faulty, or may even break.
A fault can be defined as a defect of a sensor that leads to an error. An error is the manifestation of a fault---an incorrect system state---that may result in a failure.
To ensure the dependability and the accuracy of the SHM system, sensor faults must be detected and isolated in real time. 
A well known approach to fault detection is the installation of physically redundant sensors.
Faulty sensors can be identified through the deviation of their measurements from the measurements of correlated sensors.
Physical redundancy, although efficient for sensor fault detection, causes increased installation and maintenance costs due to the multiple installation of sensors. 
Representing a more efficient approach, analytical redundancy typically uses mathematical functions mapping the characteristics of the structure and the correlations of the installed sensors \citep{Smarsly2014}. 
Virtual sensor measurements are computed for each sensor and then compared to the actual measurements. 
If the setup of a structure is known, finite element models can be used in combination with data from adjacent sensor nodes to calculate virtual measurements of a sensor.

Without a priori knowledge, analytical redundancy can be implemented into wireless sensor nodes based on artificial neural networks, that are used to predict measurements.
Artificial neural networks essentially consist of interconnected data processing units called neurons. 
The neurons are grouped in different layers; usually one input layer, a number of hidden layers, and one output layer.
Artificial neural networks are able to learn, which is achieved by adjusting the weights of the inter-neuron connections until a set of given input variables results in the desired output variables; a neural network can be trained to approximate any mathematical functions with any level of accuracy \citep{Li2011}.

In this study, a wireless SHM system capable of decentralized autonomous fault detection, is presented.
The sensor nodes calculate the natural frequency of the structure to monitor the structural integrity.
The corresponding magnitudes are used for sensor fault detection:
A neural network is implemented into each sensor node and trained---with magnitudes of past vibrations---to map the correlation of the magnitudes calculated by different sensor nodes.
During runtime, the neural networks compute expected magnitudes for the embedding sensor node.
A deviation between the expected and the measured magnitude indicates a sensor fault.

This paper is organized as follows:
First, a dezentralized wireless structural health monitoring system is designed and implemented. 
Next, a neural network is implemented into each sensor node and trained to predict the sensor measurements of the specific node for detecting sensor faults in a decentralized manner. 
Then, the system is tested in laboratory experiments. 
Finally, the experimental results are discussed and future research directions are proposed.

%----------------------------------------------------------------------------------------


\section*{Design and implementation of the wireless structural health monitoring system}
In this section, the wireless structural health monitoring system is introduced and the software implementation is described.
The wireless SHM system is composed of wireless sensor nodes and a host computer, both linked through a basestation.
The sensor nodes and the basestation are of type "Oracle Sun SPOT". 
The Sun SPOTS are equipped with several components, e.g. the sensor nodes include an internal accelerometer and eight independent RGB-LEDs.
The "3-axis digital output accelerometer with three sensitivity ranges" \citep{eDemo2010} between $\pm$\,2\,g and $\pm$\,8\,g has a maximum sampling rate of 125\,Hz.

The SHM system performs the following monitoring tasks:
1. data acquisition,
2. data processing,
3. data transmission, 
4. data storage,
5. diagnostics and 
6. information retrieval, see \citet{BisbySHM}.
The dataflow is illustrated in \autoref{fig:flow}.
Tasks 1 to 3 are executed by the sensor nodes: During system operation, the sensor nodes acquire acceleration measurements and
determine the natural frequency and the corresponding magnitude of the structure using a fast Fourier transform (FFT).
The magnitudes of the natural frequencies are fed into a neural network to detect sensor faults.
The processed data is then transmitted via radio to the basestation and, finally, to the host computer.
On the host computer, task 4 is conducted by storing the data in a MySQL database.
Task 5 and 6 are conducted on the host computer in further steps.

\begin{figure}[hbtp]
    \centering
    \includegraphics{figures/dataflow_tasks_nn.eps}
    \caption{Dataflow and associated SHM tasks}
    \label{fig:flow}
\end{figure}


The neural network represents the structure of the SHM system.
Each sensor node of the SHM system embeds a distinct neural network; a sensor node is represented by either an input neuron or an output neuron, as shown in \autoref{fig:neuralnetwork}.
Measurements of other sensor nodes are fed into the input neurons of the neural network; the output neuron returns the predicted measurement of the embedding sensor node.
Hidden neurons are used for computation and do not have a physical counterpart.

\begin{figure}[hbtp]
    \centering
    \includegraphics{figures/neuralnetwork.pdf}
    \caption{Scheme of the neural network}
    \label{fig:neuralnetwork}
\end{figure}

The SHM system is implemented in an object-oriented way using Java programming language. 
Object orientation uses objects, which are instanciated using classes. 
A class includes methods, allowing the objects to perform actions, and attributes, storing object-specific data.
The SHM system is organized in two packages---\texttt{sensornode} and \texttt{basestation} that organize several Java classes belonging to a program.

\autoref{fig:UML-sn} illustrates the classes of the \texttt{sensor\-node} package.
The package \texttt{sensor\-node} consists of the classes \texttt{Acceleration\-Sampler}, \texttt{FFT}, \texttt{Measure\-ment}, \texttt{Network\-Training}, \texttt{Communi\-cation} and \texttt{Main\-Spot}, forming the SHM system, and several classes obtained from the Java library "SNIPE" \citep{SNIPE} that implement a framework for neural networks.
The classes are embedded directly into the sensor nodes.

The \texttt{Acceleration\-Sampler} class is responsible for measuring the acceleration.
There are two phases: first, the acceleration is measured with a low sampling rate.
Once the acceleration exceeds a threshold, the second phase is entered by increasing the sampling rate. 
The measured values are stored in the sensors nodes in an array.
The different phases are indicatad by lighting different LEDs.
The \texttt{FFT} class performs a FFT on the measured accelerations to transform the measured values from time domain into frequency domain. 
With the transformed data, the magnitudes and the correlating frequencies of the measured vibrations are calculated.
Finally, the natural frequency is determined by extracting the maximal magnitude.
The \texttt{Measure\-ment} class defines analyzed measurements by storing the following parameters: the address of the sensor node, the maximal magnitude, the natural frequency and a boolean value that indicates if a sensor fault was detected during runtime.
Using the SNIPE library, a neural network is defined and created for fault detection.
The \texttt{Network\-Training} class defines a routine to train the neural network with previously measured \texttt{Measure\-ment} objects.
The \texttt{Communi\-cation} class ensures the wireless communication by opening a radio connection between the sensor node and the basestation to transfer the \texttt{Measure\-ment} objects from the sensor node to the basestation.
For starting the operation of the sensor node, the entry point of the programm is the \texttt{start\-App()} method in the \texttt{Main\-Spot} class. 
Within the \texttt{Main\-Spot} class, instances of the \texttt{Acceleration\-Sampler} class, the \texttt{FFT} class, the SNIPE neural network classes, the \texttt{Network\-Training} class and the \texttt{Communi\-cation} class are created to perform the monitoring tasks.

\begin{figure}[htbp]
    \centering
    \includegraphics[scale=0.83]{figures/uml-sensornode.pdf}
    \caption{Class diagram of the \texttt{sensornode} package ((Update auf NN folgt))}
    \label{fig:UML-sn}
\end{figure}

\autoref{fig:UML-bs} illustrates the classes of the \texttt{base\-station} package.
The package \texttt{base\-station} runs on the host computer and operates the basestation.
It includes the classes \texttt{Database\-Handler} and \texttt{Main\-Base}.
The \texttt{Database\-Handler} class establishes a connection to a MySQL database, creates a database table, if none with the specified name is available, and inserts data into the database table.
The entry point of the program is the \texttt{run()} method in the \texttt{Main\-Base} class. The \texttt{Main\-Base} class opens a radio connection between the basestation and the sensor nodes, receives data sent by the sensor nodes and creates an instance of \texttt{Database\-Handler} to insert the data into the database.

\begin{figure}[htbp]
    \centering
    \includegraphics[scale=0.85]{figures/uml-basestation.pdf}
    \caption{Class diagram of the \texttt{basestation} package}
    \label{fig:UML-bs}
\end{figure}

\section*{Laboratory experiments}
In this section, laboratory experiments, devised to validate the proposed SHM system, are described.
First, a description of the test setup is given; second, the data aquisition, data processing and sensor fault detection are illustrated; and, finally, the results are discussed. 

To validate the proposed approach in laboratory experiments, the wireless SHM system is installed on a test structure, as shown in \autoref{fig:teststructure}.
The test structure is a 4-story shear-frame structure consisting of four steel plates of 25\,cm\,$\times$\,50\,cm\,$\times$\,0.8\,mm.
The plates are mounted on threaded rods with a vertical clearance of 23\,cm.
At the bottom of the structure, the rods are fixed into a solid block of 40\,cm\,$\times$\,60\,cm\,$\times$\,30\,cm.
The SHM system is installed on the test structure by mounting one wireless sensor node to each of the three top stories.

\begin{figure}
\centering
\setlength\fboxsep{1.5em}\fcolorbox{white}{lightgray}{\includegraphics[scale=0.4]{figures/testsetup.png}}
\caption{Laboratory setup (Source: own photograph)}
\label{fig:teststructure}
\end{figure}

Ensuring a free vibration in natural frequency with little interferences, the structure is excited by a deflection of the top of the structure.

After excitation, i.e. when the acceleration threshold is exceeded as detected by the sensor nodes, the sensor nodes automatically start measuring the acceleration.
Each sensor node performs a FFT, once sufficient acceleration measurements have been collected.
By applying the FFT, the acceleration measurements are converted into the vibration frequencies and the corresponding magnitudes of the structure \cite{rao2011fast}.

\begin{itemize}
\item \textbf{neuronales Netz}
\item TRAININGSPHASE
\item Austausch der gemessenen FFT zwischen den Sensoren
\item trainieren des neuronalen Netzes, bis keine Verbesserung bei Vorhersagegenauigkeit eintritt
\item MESSPHASE
\item Austausch der gemessenen FFT zwischen den Sensoren
\item Nutzen des neuronalen Netzes, um eventuellen Fehler zu finden
\item KÜNSTLICHEN FEHLER ERZEUGEN
\item TABELLE MIT ERMITTELTEN / GEMESSENEN WERTEN; MIT / OHNE FEHLERN
\end{itemize}

%The neural network has been validated by repeated tests---using varying excitation forces, varying sampling rates, and varying quantities of measured values.


%The implementation of the FFT has been verified by plotting the frequency domain of various vibration events, see \autoref{fig:76hzfft}.
%The natural frequencies can be identified by the peaks in the magnitude graph.
%Each sensor node stores the calculated first natural frequency and the corresponding magnitude in a \texttt{Measurement} object and transmits the object to the other sensor nodes.

%\begin{figure}[htb]
%    \centering
%    \includegraphics{figures/76HzHalf.pdf}
%    \caption{frequency domain graph of the vibration}
%    \label{fig:76hzfft}
%\end{figure}

After the sensor fault detection, the \texttt{Measurement} objects of all sensor nodes ar transmitted to the basestation.
The values and detected sensor faults are stored in a MySQL database and availeble for further analysis.


%Example results are shown in \autoref{tab:lab-ex}.
%The identified magnitudes increase with ascending sensor node position from top to bottom, corresponding to the higher deflection at the top of the structure.
%
%\textit{Through FFT analysis of sampling events, the data traffic is decreased from 512 doubles per sampling event to two doubles per sampling event.
%A number stored in the used data format double occupies 8\,bytes of space.
%The data traffic is decreased by (512$-$2)$\times$8\,B\,=\,4080\,B\,=\,3,98\,MB per sampling event, decreasing data traffic by 99.6\,\%.}


%\begin{table}[hb]
%	\centering
%	\begin{tabular}{l l c c c}
%		\toprule
%		ID & Position & Magnitude & Natural frequency [Hz] & Sampling rate [Hz]\\ 
%		\midrule
%		1 & top & 3.78 & 2.2461 & 76\\ 
%		1 & middle & 3.23 & 2.2461 & 76\\ 
%		1 & bottom & 1.97 & 2.2461 & 76\\ 
%		\midrule	
%		2 & top & 5.74 & 2.2536 & 76\\  
%		2 & middle & 4.38 & 2.2536 & 76\\ 
%		2 & bottom & 2.55 & 2.2536 & 76\\
%		\midrule
%		3 & top & 8.20 & 2.2536 & 76\\
%		3 & middle & 6.35 & 2.2536 & 76\\ 
%		3 & bottom & 3.79 & 2.2536 & 76\\
%		\bottomrule
%	\end{tabular}
%	\caption{Natural frequencies of the test structure}
%	\label{tab:lab-ex}
%\end{table}

%----------------------------------------------------------------------------------------

\section*{Summary}

This paper has shown a decentralized autonomous sensor fault detection strategy for structural health monitoring systems based on neural networks. 
Autonomous sensor fault detection has been realized by implementing a neural network into each sensor node.
The neural networks have been trained to predict expected sensor measurements to be compared to actual measurments, in order to detect sensor faults.
The SHM system has been verified with laboratory experiments, proving that sensor fault detection using neural networks can improve the dependability and the accuracy of structural health monitoring systems.





The dependability and the accuracy of structural health moni\-toring systems can be affected by sensor faults. 
In this paper, the design and implementation of a wireless structural health monitoring system, capable of decentralized autonomous fault detection, are presented. 
For self-detecting sensor faults, each sensor node predicts expected sensor data and compares it to the measured sensor data. 
The predictions are computed using neural networks based on measured sensor data of adjacent sensor nodes.
In laboratory experiments, devised to validate the proposed approach, several simulated sensor faults are detected.
These results indicate that the use of neural networks for fault detection increases the dependability and the accuracy of structural health monitoring systems.

In this study, a wireless SHM system capable of decentralized autonomous fault detection, is presented.
The sensor nodes calculate the natural frequency of the structure to monitor the structural integrity.
The corresponding magnitudes are used for sensor fault detection:
A neural network is implemented into each sensor node and trained---with magnitudes of past vibrations---to map the correlation of the magnitudes calculated by different sensor nodes.
During runtime, the neural networks compute expected magnitudes for the embedding sensor node.
A deviation between the expected and the measured magnitude indicates a sensor fault.

This paper is organized as follows:
First, a dezentralized wireless structural health monitoring system is designed and implemented. 
Next, a neural network is implemented into each sensor node and trained to predict the sensor measurements of the specific node for detecting sensor faults in a decentralized manner. 
Then, the system is tested in laboratory experiments. 
Finally, the experimental results are discussed and future research directions are proposed.

%----------------------------------------------------------------------------------------

\bibliographystyle{unsrtnat}
\bibliography{literature}

\end{document}
